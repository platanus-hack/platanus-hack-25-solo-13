<script>
  import LessonPlayer from '$lib/components/slides/LessonPlayer.svelte';

  // Estado
  let leccionActiva = $state('conectores-completo'); // Lecci√≥n demo Teach ‚Üí Practice

  // Datos de lecciones de ejemplo
  const lecciones = {
    fotosintesis: {
      leccionId: "fotosintesis-intro",
      titulo: "Introducci√≥n a la Fotos√≠ntesis",
      materia: "Biolog√≠a",
      slides: [
        {
          tipo: "ConceptIntroSlide",
          orden: 1,
          props: {
            concepto: "Fotos√≠ntesis",
            definicionSimple: "La fotos√≠ntesis es el proceso mediante el cual las plantas convierten la luz solar en alimento (glucosa), liberando ox√≠geno como subproducto.",
            definicionTecnica: "6CO‚ÇÇ + 6H‚ÇÇO + luz ‚Üí C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ + 6O‚ÇÇ. Proceso anab√≥lico donde organismos aut√≥trofos sintetizan mol√©culas org√°nicas complejas a partir de sustancias simples usando energ√≠a lum√≠nica.",
            imagen: null,
            terminosClave: [
              { palabra: "aut√≥trofos", tooltip: "Organismos que producen su propio alimento, como las plantas" },
              { palabra: "clorofila", tooltip: "Pigmento verde que captura la energ√≠a lum√≠nica" },
              { palabra: "glucosa", tooltip: "Az√∫car simple (C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ) que almacena energ√≠a qu√≠mica" }
            ],
            colorTema: "emerald",
            materia: "biolog√≠a"
          }
        },
        {
          tipo: "StepByStepProcessSlide",
          orden: 2,
          props: {
            titulo: "Las dos fases de la Fotos√≠ntesis",
            pasos: [
              {
                numero: 1,
                titulo: "Fase Luminosa (Reacciones de luz)",
                contenido: "Ocurre en los tilacoides del cloroplasto. La clorofila absorbe luz solar y la convierte en energ√≠a qu√≠mica (ATP y NADPH). Se libera ox√≠geno al descomponer mol√©culas de agua.",
                ejemplo: "H‚ÇÇO + luz ‚Üí O‚ÇÇ + ATP + NADPH",
                ayudaVisual: null
              },
              {
                numero: 2,
                titulo: "Fase Oscura (Ciclo de Calvin)",
                contenido: "Ocurre en el estroma del cloroplasto. Usa el ATP y NADPH de la fase luminosa para convertir CO‚ÇÇ en glucosa. No requiere luz directa.",
                ejemplo: "CO‚ÇÇ + ATP + NADPH ‚Üí C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ",
                ayudaVisual: null
              },
              {
                numero: 3,
                titulo: "Producto Final",
                contenido: "La glucosa producida se usa para crecimiento, almacenamiento de energ√≠a (almid√≥n) o respiraci√≥n celular. El ox√≠geno se libera a la atm√≥sfera.",
                ejemplo: "1 mol√©cula de glucosa = energ√≠a para 38 mol√©culas de ATP",
                ayudaVisual: null
              }
            ],
            materia: "biolog√≠a",
            requiereConfirmacion: false,
            mostrarProgreso: true
          }
        },
        {
          tipo: "ComparisonTableSlide",
          orden: 3,
          props: {
            titulo: "Fase Luminosa vs Fase Oscura",
            items: [
              { nombre: "Fase Luminosa", color: "yellow" },
              { nombre: "Fase Oscura", color: "purple" }
            ],
            filas: [
              {
                caracteristica: "Ubicaci√≥n",
                valores: ["Tilacoides", "Estroma"],
                tipo: "diferencia",
                detalles: "Los tilacoides son membranas internas del cloroplasto, el estroma es el fluido que los rodea"
              },
              {
                caracteristica: "Requiere luz",
                valores: ["S√≠, directamente", "No directamente"],
                tipo: "diferencia",
                detalles: "La fase oscura usa productos de la fase luminosa, pero no necesita luz en ese momento"
              },
              {
                caracteristica: "Productos",
                valores: ["ATP, NADPH, O‚ÇÇ", "Glucosa (C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ)"],
                tipo: "diferencia"
              },
              {
                caracteristica: "Reactivos principales",
                valores: ["H‚ÇÇO, luz", "CO‚ÇÇ, ATP, NADPH"],
                tipo: "diferencia"
              },
              {
                caracteristica: "Funci√≥n",
                valores: ["Capturar energ√≠a", "Sintetizar glucosa"],
                tipo: "diferencia"
              }
            ],
            materia: "biolog√≠a",
            mostrarFiltros: true
          }
        },
        {
          tipo: "PracticePromptSlide",
          orden: 4,
          props: {
            mensaje: "¬°Ahora dominas la Fotos√≠ntesis!",
            submensaje: "Refuerza lo aprendido con algunos ejercicios pr√°cticos",
            icono: "üå±",
            previewEjercicios: [
              { tipo: "Verdadero/Falso", cantidad: 3, icono: "‚úì‚úó" },
              { tipo: "Selecci√≥n M√∫ltiple", cantidad: 5, icono: "‚òëÔ∏è" },
              { tipo: "Completar Blancos", cantidad: 2, icono: "___" }
            ],
            motivacion: "¬°Excelente! Ya comprendes el 70% de Biolog√≠a Celular",
            botonTexto: "Comenzar Ejercicios",
            colorTema: "emerald",
            materia: "biolog√≠a"
          }
        }
      ]
    },

    ecuaciones: {
      leccionId: "ecuaciones-segundo-grado",
      titulo: "Ecuaciones de Segundo Grado",
      materia: "Matem√°ticas",
      slides: [
        {
          tipo: "ConceptIntroSlide",
          orden: 1,
          props: {
            concepto: "Ecuaci√≥n Cuadr√°tica",
            definicionSimple: "Una ecuaci√≥n de segundo grado es aquella donde la variable est√° elevada al cuadrado. Tiene la forma ax¬≤ + bx + c = 0.",
            definicionTecnica: "Ecuaci√≥n polin√≥mica de grado 2 de la forma ax¬≤ + bx + c = 0, donde a ‚â† 0. Sus soluciones se obtienen mediante la f√≥rmula general: x = (-b ¬± ‚àö(b¬≤-4ac)) / 2a",
            imagen: null,
            terminosClave: [
              { palabra: "coeficientes", tooltip: "Los n√∫meros a, b, c que multiplican a las variables" },
              { palabra: "discriminante", tooltip: "b¬≤-4ac, determina el n√∫mero de soluciones reales" },
              { palabra: "ra√≠ces", tooltip: "Los valores de x que satisfacen la ecuaci√≥n" }
            ],
            colorTema: "cyan",
            materia: "matem√°ticas"
          }
        },
        {
          tipo: "StepByStepProcessSlide",
          orden: 2,
          props: {
            titulo: "Resolver una Ecuaci√≥n Cuadr√°tica",
            pasos: [
              {
                numero: 1,
                titulo: "Identificar coeficientes a, b, c",
                contenido: "En la forma ax¬≤ + bx + c = 0, identifica los valores de a (coeficiente de x¬≤), b (coeficiente de x), y c (t√©rmino independiente).",
                ejemplo: "2x¬≤ + 5x - 3 = 0 ‚Üí a=2, b=5, c=-3"
              },
              {
                numero: 2,
                titulo: "Calcular el discriminante",
                contenido: "Calcula Œî = b¬≤ - 4ac. Este valor determina cu√°ntas soluciones reales tiene la ecuaci√≥n.",
                ejemplo: "Œî = 5¬≤ - 4(2)(-3) = 25 + 24 = 49"
              },
              {
                numero: 3,
                titulo: "Aplicar la f√≥rmula general",
                contenido: "Sustituye en x = (-b ¬± ‚àöŒî) / 2a para obtener las dos soluciones.",
                ejemplo: "x = (-5 ¬± ‚àö49) / 4 = (-5 ¬± 7) / 4"
              },
              {
                numero: 4,
                titulo: "Calcular ambas soluciones",
                contenido: "Resuelve con + y con - para obtener x‚ÇÅ y x‚ÇÇ.",
                ejemplo: "x‚ÇÅ = (-5 + 7) / 4 = 0.5; x‚ÇÇ = (-5 - 7) / 4 = -3"
              }
            ],
            materia: "matem√°ticas",
            requiereConfirmacion: true,
            mostrarProgreso: true
          }
        },
        {
          tipo: "FormulaExplorerSlide",
          orden: 3,
          props: {
            titulo: "Explora la F√≥rmula General",
            formula: "x = (-b ¬± ‚àö(b¬≤-4ac)) / 2a",
            variables: [
              {
                simbolo: "a",
                nombre: "Coeficiente cuadr√°tico",
                unidad: "",
                descripcion: "Coeficiente del t√©rmino x¬≤ (debe ser ‚â† 0)"
              },
              {
                simbolo: "b",
                nombre: "Coeficiente lineal",
                unidad: "",
                descripcion: "Coeficiente del t√©rmino x"
              },
              {
                simbolo: "c",
                nombre: "T√©rmino independiente",
                unidad: "",
                descripcion: "T√©rmino constante sin variable"
              }
            ],
            ejemploNumerico: {
              a: 1,
              b: -3,
              c: 2,
              sustitucion: "x = (3 ¬± ‚àö(9-8)) / 2 = (3 ¬± 1) / 2",
              resultado: "x‚ÇÅ = 2, x‚ÇÇ = 1",
              unidadResultado: ""
            },
            calculadoraInteractiva: false,
            materia: "matem√°ticas",
            mostrarUnidades: false
          }
        },
        {
          tipo: "PracticePromptSlide",
          orden: 4,
          props: {
            mensaje: "¬°Listo para resolver ecuaciones!",
            submensaje: "Practica con 10 ecuaciones de dificultad progresiva",
            icono: "üéØ",
            previewEjercicios: [
              { tipo: "Ecuaciones simples", cantidad: 3, icono: "üìê" },
              { tipo: "Ecuaciones intermedias", cantidad: 4, icono: "üìä" },
              { tipo: "Problemas aplicados", cantidad: 3, icono: "üßÆ" }
            ],
            motivacion: "Dominas el 85% de √Ålgebra - ¬°Sigue as√≠!",
            botonTexto: "Practicar Ahora",
            colorTema: "cyan",
            materia: "matem√°ticas"
          }
        }
      ]
    },

    // LECCIONES DE LENGUAJE
    'comprension-garcia-marquez': {
      leccionId: "comprension-garcia-marquez",
      titulo: "Comprensi√≥n Lectora: Cien A√±os de Soledad",
      materia: "Lenguaje",
      slides: [
        {
          tipo: "TextAnnotationSlide",
          orden: 1,
          props: {
            titulo: "An√°lisis: 'Cien A√±os de Soledad' - Fragmento",
            texto: `Muchos a√±os despu√©s, frente al pelot√≥n de fusilamiento, el coronel Aureliano Buend√≠a hab√≠a de recordar aquella tarde remota en que su padre lo llev√≥ a conocer el hielo. Macondo era entonces una aldea de veinte casas de barro y ca√±abrava construidas a la orilla de un r√≠o de aguas di√°fanas que se precipitaban por un lecho de piedras pulidas, blancas y enormes como huevos prehist√≥ricos. El mundo era tan reciente, que muchas cosas carec√≠an de nombre, y para mencionarlas hab√≠a que se√±alarlas con el dedo.`,
            tipoLectura: "narrativa",
            preguntasGuia: [
              "¬øQu√© t√©cnica narrativa usa Garc√≠a M√°rquez al comenzar in medias res?",
              "¬øQu√© ambiente describe el autor en el segundo p√°rrafo?",
              "Identifica elementos del realismo m√°gico en el fragmento"
            ],
            vocabularioDestacado: ["pelot√≥n", "fusilamiento", "remota", "di√°fanas"],
            herramientasAnotacion: ["resaltar", "notas"],
            materia: "lenguaje"
          }
        },
        {
          tipo: "VocabularyContextSlide",
          orden: 2,
          props: {
            palabraObjetivo: "di√°fano",
            pronunciacion: "/di.Ààa.fa.no/",
            audioUrl: null,
            etimologia: "Del lat√≠n 'diaphanus', y este del griego 'diaphan√©s': transparente",
            definicion: "Que deja pasar la luz casi en su totalidad. Tambi√©n se usa figuradamente para referirse a algo claro, limpio y transparente.",
            morfologia: {
              prefijo: "dia- (a trav√©s de)",
              raiz: "phan (aparecer, mostrar)",
              sufijo: "-o (adjetivo)"
            },
            contextosEjemplo: [
              "El r√≠o de aguas di√°fanas reflejaba el sol de la ma√±ana.",
              "Su explicaci√≥n fue di√°fana y todos la comprendieron.",
              "El cristal di√°fano de la ventana permit√≠a ver el jard√≠n."
            ],
            imagenes: [],
            sinonimos: ["transparente", "claro", "l√≠mpido", "cristalino"],
            antonimos: ["opaco", "turbio", "oscuro"],
            palabrasFamilia: ["diafanidad", "di√°fanamente"],
            materia: "lenguaje"
          }
        },
        {
          tipo: "LiteraryDevicesExplorerSlide",
          orden: 3,
          props: {
            titulo: "Recursos Literarios en Garc√≠a M√°rquez",
            texto: `Muchos a√±os despu√©s, frente al pelot√≥n de fusilamiento, el coronel Aureliano Buend√≠a hab√≠a de recordar aquella tarde remota en que su padre lo llev√≥ a conocer el hielo.`,
            autor: "Gabriel Garc√≠a M√°rquez",
            dispositivosLiterarios: [
              {
                tipo: "anafora",
                ejemplos: ["Muchos a√±os despu√©s"],
                definicion: "Repetici√≥n de palabras al inicio de frases sucesivas",
                efecto: "Crea ritmo y √©nfasis temporal, estableciendo distancia narrativa",
                color: "purple"
              },
              {
                tipo: "metafora",
                ejemplos: ["tarde remota"],
                definicion: "Comparaci√≥n impl√≠cita entre dos elementos sin usar 'como'",
                efecto: "Evoca nostalgia y distancia temporal de manera po√©tica",
                color: "blue"
              },
              {
                tipo: "simil",
                ejemplos: ["piedras pulidas, blancas y enormes como huevos prehist√≥ricos"],
                definicion: "Comparaci√≥n expl√≠cita usando 'como' o 'cual'",
                efecto: "Crea una imagen visual potente y surrealista, caracter√≠stica del realismo m√°gico",
                color: "green"
              }
            ],
            preguntasAnalisis: [
              "¬øPor qu√© Garc√≠a M√°rquez comienza la novela con una anticipaci√≥n?",
              "¬øQu√© efecto tiene la imagen de las piedras como 'huevos prehist√≥ricos'?"
            ],
            modoComparacion: false,
            ejercicioCreativo: "Escribe una oraci√≥n usando met√°fora y otra usando s√≠mil",
            materia: "lenguaje"
          }
        },
        {
          tipo: "PracticePromptSlide",
          orden: 4,
          props: {
            mensaje: "¬°Ahora dominas el an√°lisis literario!",
            submensaje: "Refuerza lo aprendido con ejercicios de comprensi√≥n",
            icono: "üìö",
            previewEjercicios: [
              { tipo: "An√°lisis de texto", cantidad: 3, icono: "üìñ" },
              { tipo: "Vocabulario contextual", cantidad: 5, icono: "üìù" },
              { tipo: "Recursos literarios", cantidad: 4, icono: "‚ú®" }
            ],
            motivacion: "¬°Excelente! Ya comprendes t√©cnicas narrativas avanzadas",
            botonTexto: "Comenzar Ejercicios",
            colorTema: "purple",
            materia: "lenguaje"
          }
        }
      ]
    },

    'gramatica-oraciones': {
      leccionId: "gramatica-oraciones",
      titulo: "Gram√°tica: Construcci√≥n de Oraciones Complejas",
      materia: "Lenguaje",
      slides: [
        {
          tipo: "SentenceBuilderSlide",
          orden: 1,
          props: {
            titulo: "Construye Oraciones Simples y Compuestas",
            modoEjercicio: "guided",
            oracionBase: null,
            palabrasDisponibles: [
              { texto: "El estudiante", tipo: "sujeto", color: "blue" },
              { texto: "chileno", tipo: "adjetivo", color: "purple" },
              { texto: "estudia", tipo: "verbo", color: "red" },
              { texto: "diligentemente", tipo: "adverbio", color: "orange" },
              { texto: "para la PAES", tipo: "complemento", color: "green" },
              { texto: "en la biblioteca", tipo: "complemento", color: "green" }
            ],
            objetivoGramatical: "Construye una oraci√≥n compleja agregando modificadores al sujeto y al verbo",
            variacionesCorrectas: [
              "El estudiante chileno estudia diligentemente para la PAES",
              "El estudiante estudia diligentemente para la PAES en la biblioteca",
              "El estudiante chileno estudia diligentemente para la PAES en la biblioteca"
            ],
            mostrarScaffolding: true,
            materia: "lenguaje"
          }
        },
        {
          tipo: "ConnectorsWorkshopSlide",
          orden: 2,
          props: {
            titulo: "Conectores: Dando Coherencia al Texto",
            parrafos: [
              {
                texto: "El cambio clim√°tico es una realidad cient√≠fica. ___ debemos actuar con urgencia para mitigar sus efectos.",
                opcionesConector: ["Por lo tanto", "Sin embargo", "Adem√°s"],
                correcta: "Por lo tanto",
                tipo: "consecutivos",
                explicacion: "El segundo enunciado es una consecuencia l√≥gica del primero, por eso usamos un conector consecutivo"
              },
              {
                texto: "Chile es l√≠der en energ√≠a solar en Sudam√©rica. ___ muchos pa√≠ses a√∫n dependen de combustibles f√≥siles.",
                opcionesConector: ["Adem√°s", "Sin embargo", "Por eso"],
                correcta: "Sin embargo",
                tipo: "adversativos",
                explicacion: "Se presenta un contraste entre Chile y otros pa√≠ses, requiere un conector adversativo"
              },
              {
                texto: "Las energ√≠as renovables reducen emisiones. ___ crean empleos verdes en las comunidades.",
                opcionesConector: ["Adem√°s", "Por lo tanto", "Aunque"],
                correcta: "Adem√°s",
                tipo: "aditivos",
                explicacion: "Se agrega informaci√≥n complementaria, se usa conector aditivo"
              }
            ],
            categorias: ["causales", "adversativos", "consecutivos", "aditivos"],
            bancoConectores: {
              causales: ["porque", "ya que", "debido a", "puesto que"],
              adversativos: ["sin embargo", "no obstante", "pero", "aunque"],
              consecutivos: ["por lo tanto", "en consecuencia", "as√≠ que", "entonces"],
              aditivos: ["adem√°s", "asimismo", "tambi√©n", "igualmente"]
            },
            modoComparacion: false,
            ejercicioCreativo: "Escribe un p√°rrafo sobre tu ciudad usando al menos 3 tipos diferentes de conectores",
            materia: "lenguaje"
          }
        },
        {
          tipo: "VocabularyContextSlide",
          orden: 3,
          props: {
            palabraObjetivo: "resiliente",
            pronunciacion: "/re.si.Ààljen.te/",
            audioUrl: null,
            etimologia: "Del lat√≠n 'resilire': saltar hacia atr√°s, rebotar",
            definicion: "Capacidad de un material, persona o ecosistema para recuperarse ante adversidades o perturbaciones.",
            morfologia: {
              prefijo: "re- (de nuevo)",
              raiz: "sil (saltar)",
              sufijo: "-ente (que realiza la acci√≥n)"
            },
            contextosEjemplo: [
              "Los ecosistemas resilientes se recuperan r√°pidamente despu√©s de incendios forestales.",
              "Mar√≠a demostr√≥ ser resiliente tras perder su empleo durante la pandemia.",
              "Necesitamos materiales resilientes para construcciones antis√≠smicas en Chile."
            ],
            imagenes: [],
            sinonimos: ["resistente", "adaptable", "fuerte", "flexible"],
            antonimos: ["fr√°gil", "d√©bil", "vulnerable", "quebradizo"],
            palabrasFamilia: ["resiliencia", "resilir"],
            materia: "lenguaje"
          }
        },
        {
          tipo: "PracticePromptSlide",
          orden: 4,
          props: {
            mensaje: "¬°Listo para escribir con coherencia!",
            submensaje: "Practica con ejercicios de redacci√≥n y gram√°tica",
            icono: "‚úçÔ∏è",
            previewEjercicios: [
              { tipo: "Construcci√≥n de oraciones", cantidad: 5, icono: "üî®" },
              { tipo: "Uso de conectores", cantidad: 6, icono: "üîó" },
              { tipo: "Vocabulario en contexto", cantidad: 4, icono: "üìö" }
            ],
            motivacion: "Dominas el 80% de Gram√°tica y Redacci√≥n - ¬°Sigue as√≠!",
            botonTexto: "Practicar Ahora",
            colorTema: "purple",
            materia: "lenguaje"
          }
        }
      ]
    },

    'escritura-argumentativa': {
      leccionId: "escritura-argumentativa",
      titulo: "Escritura Argumentativa: Estructura y Coherencia",
      materia: "Lenguaje",
      slides: [
        {
          tipo: "TextStructureSlide",
          orden: 1,
          props: {
            titulo: "Estructura de un Texto Argumentativo",
            tipoTexto: "argumentativo",
            textoEjemplo: "Texto sobre energ√≠as renovables en Chile",
            estructura: {
              introduccion: {
                texto: "Chile enfrenta desaf√≠os importantes en materia energ√©tica. El pa√≠s debe decidir entre continuar con energ√≠as tradicionales o transitar hacia fuentes renovables.",
                color: "blue",
                descripcion: "Contextualiza el tema y presenta el problema"
              },
              tesis: {
                texto: "Chile debe aumentar significativamente su inversi√≥n en energ√≠as renovables para combatir el cambio clim√°tico y asegurar la sustentabilidad energ√©tica del pa√≠s.",
                color: "purple",
                descripcion: "Postura clara y defendible del autor"
              },
              argumentos: {
                texto: "Argumento 1: Reduce emisiones de CO‚ÇÇ. Estudios del MIT demuestran que invertir en solar y e√≥lica reduce emisiones en un 40% en 10 a√±os. Argumento 2: Crea empleos verdes. El sector solar cre√≥ 50,000 empleos en Chile en 2023, dinamizando la econom√≠a regional.",
                color: "green",
                descripcion: "Razones y evidencia que apoyan la tesis"
              },
              contraargumentos: {
                texto: "Algunos argumentan que es muy costoso. Sin embargo, los costos de energ√≠a solar han bajado 90% desde 2010 seg√∫n IRENA, haci√©ndola competitiva con combustibles f√≥siles.",
                color: "red",
                descripcion: "Reconoce y refuta objeciones"
              },
              conclusion: {
                texto: "Por lo tanto, la inversi√≥n en energ√≠as renovables no solo es viable econ√≥micamente, sino necesaria para el futuro sustentable de Chile.",
                color: "orange",
                descripcion: "Retoma la tesis y cierra el argumento"
              }
            },
            ejercicioTipo: "solo-visualizar",
            comparacionTipos: true,
            materia: "lenguaje"
          }
        },
        {
          tipo: "TextAnnotationSlide",
          orden: 2,
          props: {
            titulo: "Analiza un Ensayo Argumentativo",
            texto: `Introducci√≥n: En la era digital, el uso excesivo de redes sociales ha generado un debate sobre su impacto en adolescentes chilenos.

Tesis: Las redes sociales, si bien ofrecen beneficios de conectividad, generan m√°s perjuicios que beneficios en el desarrollo socioemocional de los j√≥venes.

Argumento 1: Diversos estudios demuestran que el uso prolongado de Instagram y TikTok est√° asociado con mayor ansiedad y depresi√≥n en adolescentes. Un estudio de la Universidad de Chile (2023) revel√≥ que el 65% de j√≥venes entre 14-18 a√±os reporta sentimientos de inadecuaci√≥n al compararse con contenido en redes.

Contraargumento y refutaci√≥n: Aunque las redes permiten mantener contacto con amigos, esta conexi√≥n es superficial. La comunicaci√≥n cara a cara desarrolla habilidades sociales m√°s profundas que el intercambio de mensajes.

Conclusi√≥n: Por lo tanto, es urgente educar sobre uso responsable de redes sociales para proteger la salud mental juvenil.`,
            tipoLectura: "argumentativa",
            preguntasGuia: [
              "Identifica la tesis del texto",
              "¬øQu√© evidencia usa el autor para su argumento principal?",
              "¬øC√≥mo refuta el autor el contraargumento?"
            ],
            vocabularioDestacado: ["inadecuaci√≥n", "socioemocional", "superficial"],
            herramientasAnotacion: ["resaltar", "notas"],
            materia: "lenguaje"
          }
        },
        {
          tipo: "ConnectorsWorkshopSlide",
          orden: 3,
          props: {
            titulo: "Conectores en Textos Argumentativos",
            parrafos: [
              {
                texto: "La educaci√≥n online tiene ventajas como flexibilidad horaria. ___ presenta desaf√≠os en la interacci√≥n social de los estudiantes.",
                opcionesConector: ["Adem√°s", "Sin embargo", "Por consiguiente"],
                correcta: "Sin embargo",
                tipo: "adversativos",
                explicacion: "Se presenta un contraste entre ventajas y desaf√≠os"
              },
              {
                texto: "Los j√≥venes pasan m√°s de 5 horas diarias en redes sociales. ___ es necesario implementar programas de alfabetizaci√≥n digital en los colegios.",
                opcionesConector: ["Por lo tanto", "Aunque", "Adem√°s"],
                correcta: "Por lo tanto",
                tipo: "consecutivos",
                explicacion: "La segunda oraci√≥n es una consecuencia l√≥gica de la primera"
              }
            ],
            categorias: ["adversativos", "consecutivos", "causales", "aditivos"],
            bancoConectores: {
              causales: ["porque", "ya que", "debido a"],
              adversativos: ["sin embargo", "no obstante", "aunque"],
              consecutivos: ["por lo tanto", "en consecuencia", "por consiguiente"],
              aditivos: ["adem√°s", "asimismo", "tambi√©n"]
            },
            modoComparacion: false,
            ejercicioCreativo: null,
            materia: "lenguaje"
          }
        },
        {
          tipo: "PracticePromptSlide",
          orden: 4,
          props: {
            mensaje: "¬°Ya puedes escribir ensayos argumentativos!",
            submensaje: "Practica redactando tu propio ensayo sobre un tema actual",
            icono: "üìù",
            previewEjercicios: [
              { tipo: "Identificar estructuras", cantidad: 4, icono: "üèóÔ∏è" },
              { tipo: "Redactar argumentos", cantidad: 3, icono: "üí≠" },
              { tipo: "Uso de evidencia", cantidad: 3, icono: "üìä" }
            ],
            motivacion: "¬°Excelente progreso! Dominas escritura argumentativa al 85%",
            botonTexto: "Comenzar a Escribir",
            colorTema: "purple",
            materia: "lenguaje"
          }
        }
      ]
    },

    // LECCI√ìN DEMO: TEACH ‚Üí PRACTICE
    'conectores-completo': {
      leccionId: "conectores-completo",
      titulo: "Conectores Textuales: De la Teor√≠a a la Pr√°ctica",
      materia: "Lenguaje",
      slides: [
        // SLIDE 1: TEACH - Introducci√≥n a conectores
        {
          tipo: "ConnectorsGuideSlide",
          orden: 1,
          props: {
            titulo: "Gu√≠a Completa de Conectores Textuales",
            importancia: "Los conectores son palabras o frases que unen ideas y dan coherencia al texto, esenciales para la PAES de Lenguaje",
            categorias: [
              {
                nombre: "Causales",
                tipo: "causal",
                definicion: "Indican la causa o raz√≥n de algo",
                funcion: "Expresan relaci√≥n de causa-efecto entre ideas",
                conectores: [
                  {
                    palabra: "porque",
                    nivel: "b√°sico",
                    ejemplos: [
                      "Estudi√≥ toda la noche porque ten√≠a examen al d√≠a siguiente.",
                      "No sali√≥ porque estaba lloviendo."
                    ],
                    nota: "El conector causal m√°s com√∫n en espa√±ol"
                  },
                  {
                    palabra: "ya que",
                    nivel: "formal",
                    ejemplos: [
                      "Aprob√≥ el curso ya que cumpli√≥ con todos los requisitos.",
                      "El proyecto fue cancelado ya que no hab√≠a presupuesto."
                    ]
                  },
                  {
                    palabra: "debido a que",
                    nivel: "formal",
                    ejemplos: [
                      "La reuni√≥n se pospuso debido a que falt√≥ el director."
                    ]
                  }
                ],
                ejemploParrafo: "El reciclaje es fundamental para el medio ambiente porque reduce la cantidad de desechos. Ya que muchas personas no est√°n conscientes de su importancia, es necesario educar desde las escuelas.",
                comparacion: "A diferencia de los consecutivos que muestran resultado, los causales muestran el origen o raz√≥n"
              },
              {
                nombre: "Adversativos",
                tipo: "adversativo",
                definicion: "Expresan oposici√≥n o contraste entre ideas",
                funcion: "Marcan un cambio de direcci√≥n en el argumento",
                conectores: [
                  {
                    palabra: "sin embargo",
                    nivel: "formal",
                    ejemplos: [
                      "Estudi√≥ mucho; sin embargo, no aprob√≥ el examen.",
                      "La propuesta era buena; sin embargo, fue rechazada."
                    ],
                    nota: "Usado frecuentemente en textos argumentativos"
                  },
                  {
                    palabra: "pero",
                    nivel: "b√°sico",
                    ejemplos: [
                      "Quer√≠a ir al cine, pero no ten√≠a dinero.",
                      "Es inteligente, pero no estudia."
                    ]
                  },
                  {
                    palabra: "no obstante",
                    nivel: "muy formal",
                    ejemplos: [
                      "El clima era adverso; no obstante, continuaron la expedici√≥n."
                    ]
                  }
                ],
                ejemploParrafo: "Las energ√≠as renovables son m√°s limpias. Sin embargo, su implementaci√≥n requiere inversi√≥n inicial alta. No obstante, a largo plazo resultan m√°s econ√≥micas.",
                comparacion: "Los adversativos contradicen la idea anterior, mientras que los aditivos la complementan"
              },
              {
                nombre: "Consecutivos",
                tipo: "consecutivo",
                definicion: "Indican consecuencia o resultado de una acci√≥n",
                funcion: "Muestran el efecto o resultado de una causa",
                conectores: [
                  {
                    palabra: "por lo tanto",
                    nivel: "formal",
                    ejemplos: [
                      "El experimento fall√≥; por lo tanto, debemos repetirlo.",
                      "No hay evidencia; por lo tanto, se desestima la acusaci√≥n."
                    ],
                    nota: "Muy com√∫n en textos acad√©micos y cient√≠ficos"
                  },
                  {
                    palabra: "en consecuencia",
                    nivel: "formal",
                    ejemplos: [
                      "Viol√≥ las reglas; en consecuencia, fue expulsado."
                    ]
                  },
                  {
                    palabra: "as√≠ que",
                    nivel: "b√°sico",
                    ejemplos: [
                      "Estaba cansado, as√≠ que se fue a dormir."
                    ]
                  }
                ],
                ejemploParrafo: "La deforestaci√≥n aumenta el CO‚ÇÇ en la atm√≥sfera. Por lo tanto, contribuye al calentamiento global. En consecuencia, debemos proteger los bosques.",
                comparacion: "Los consecutivos muestran el resultado, mientras que los causales muestran la raz√≥n"
              },
              {
                nombre: "Aditivos",
                tipo: "aditivo",
                definicion: "Agregan informaci√≥n complementaria",
                funcion: "Suman ideas o argumentos en la misma direcci√≥n",
                conectores: [
                  {
                    palabra: "adem√°s",
                    nivel: "b√°sico",
                    ejemplos: [
                      "Es inteligente. Adem√°s, es muy trabajador.",
                      "Lleg√≥ tarde. Adem√°s, no trajo los documentos."
                    ],
                    nota: "Uno de los conectores aditivos m√°s vers√°tiles"
                  },
                  {
                    palabra: "asimismo",
                    nivel: "formal",
                    ejemplos: [
                      "La propuesta es viable. Asimismo, es econ√≥mica."
                    ]
                  },
                  {
                    palabra: "tambi√©n",
                    nivel: "b√°sico",
                    ejemplos: [
                      "Estudia matem√°ticas. Tambi√©n estudia f√≠sica."
                    ]
                  }
                ],
                ejemploParrafo: "La lectura mejora el vocabulario. Adem√°s, desarrolla la imaginaci√≥n. Asimismo, fortalece la concentraci√≥n.",
                comparacion: "Los aditivos suman ideas del mismo tipo, mientras que los adversativos las contrastan"
              },
              {
                nombre: "Temporales",
                tipo: "temporal",
                definicion: "Indican relaciones de tiempo entre eventos",
                funcion: "Organizan eventos en secuencia cronol√≥gica",
                conectores: [
                  {
                    palabra: "luego",
                    nivel: "b√°sico",
                    ejemplos: [
                      "Desayun√≥. Luego se fue a trabajar.",
                      "Primero estudi√≥ teor√≠a. Luego hizo los ejercicios."
                    ]
                  },
                  {
                    palabra: "despu√©s",
                    nivel: "b√°sico",
                    ejemplos: [
                      "Termin√≥ la tarea. Despu√©s sali√≥ a jugar."
                    ]
                  },
                  {
                    palabra: "finalmente",
                    nivel: "b√°sico",
                    ejemplos: [
                      "Prepar√≥ los ingredientes. Cocin√≥ el plato. Finalmente, lo sirvi√≥."
                    ],
                    nota: "Indica el √∫ltimo paso en una secuencia"
                  }
                ],
                ejemploParrafo: "Primero, se mezclan los ingredientes secos. Luego, se agregan los l√≠quidos. Despu√©s, se hornea durante 30 minutos. Finalmente, se deja enfriar.",
                comparacion: "Los temporales organizan en el tiempo, mientras que los consecutivos organizan por causa-efecto"
              }
            ],
            consejos: [
              "Var√≠a los conectores para evitar repetici√≥n",
              "Usa conectores formales en textos acad√©micos",
              "No abuses de los conectores: √∫salos solo cuando sea necesario",
              "Aseg√∫rate de que el conector elegido refleje la relaci√≥n l√≥gica correcta",
              "En la PAES, identifica primero la relaci√≥n entre ideas antes de elegir el conector"
            ],
            materia: "lenguaje"
          }
        },

        // SLIDE 2: PRACTICE - Aplicar conocimiento de conectores
        {
          tipo: "ConnectorsWorkshopSlide",
          orden: 2,
          props: {
            titulo: "Practica: Elige el Conector Correcto",
            parrafos: [
              {
                texto: "El reciclaje reduce la contaminaci√≥n. ___ ayuda a conservar los recursos naturales.",
                opcionesConector: ["Por lo tanto", "Adem√°s", "Sin embargo"],
                correcta: "Adem√°s",
                tipo: "aditivos",
                explicacion: "Se est√° agregando una ventaja adicional del reciclaje, no una consecuencia ni un contraste"
              },
              {
                texto: "Quer√≠a comprar el libro. ___ no ten√≠a suficiente dinero.",
                opcionesConector: ["Sin embargo", "Por lo tanto", "Porque"],
                correcta: "Sin embargo",
                tipo: "adversativos",
                explicacion: "Hay contraste entre el deseo y la imposibilidad de realizarlo"
              },
              {
                texto: "No estudi√≥ para el examen. ___ reprob√≥ el curso.",
                opcionesConector: ["Adem√°s", "Por lo tanto", "Sin embargo"],
                correcta: "Por lo tanto",
                tipo: "consecutivos",
                explicacion: "Reprobar es la consecuencia l√≥gica de no estudiar"
              },
              {
                texto: "La energ√≠a solar es limpia. ___ cada vez es m√°s accesible econ√≥micamente.",
                opcionesConector: ["Adem√°s", "Sin embargo", "Por lo tanto"],
                correcta: "Adem√°s",
                tipo: "aditivos",
                explicacion: "Se suma otro beneficio de la energ√≠a solar"
              },
              {
                texto: "Lleg√≥ temprano a la reuni√≥n. ___ todos lo felicitaron por su puntualidad.",
                opcionesConector: ["Luego", "Porque", "Sin embargo"],
                correcta: "Luego",
                tipo: "temporales",
                explicacion: "Indica la secuencia temporal: primero lleg√≥, despu√©s lo felicitaron"
              }
            ],
            ejercicioCreativo: "Escribe un p√°rrafo de 4 oraciones sobre las energ√≠as renovables usando al menos 3 conectores diferentes (uno causal, uno adversativo y uno consecutivo)",
            materia: "lenguaje"
          }
        },

        // SLIDE 3: TEACH - Gram√°tica
        {
          tipo: "GrammarConceptSlide",
          orden: 3,
          props: {
            titulo: "Tipos de Sujeto en Espa√±ol",
            concepto: "Sujeto",
            definicion: "El sujeto es la persona, animal o cosa que realiza la acci√≥n del verbo o de quien se dice algo. Responde a las preguntas '¬øqui√©n?' o '¬øqui√©nes?'",
            tipos: [
              {
                nombre: "Sujeto Expreso",
                definicion: "El sujeto est√° expl√≠citamente mencionado en la oraci√≥n",
                caracteristicas: [
                  "Se menciona directamente en la oraci√≥n",
                  "Puede estar al inicio, medio o final de la oraci√≥n",
                  "Concuerda en n√∫mero y persona con el verbo"
                ],
                ejemplos: [
                  {
                    oracion: "Los estudiantes chilenos se preparan para la PAES",
                    analisis: "Sujeto expreso: 'Los estudiantes chilenos' (3¬™ persona plural)"
                  },
                  {
                    oracion: "Mar√≠a y Pedro estudian juntos en la biblioteca",
                    analisis: "Sujeto expreso compuesto: 'Mar√≠a y Pedro'"
                  },
                  {
                    oracion: "En la sala de clases explic√≥ el profesor el teorema de Pit√°goras",
                    analisis: "Sujeto expreso pospuesto: 'el profesor' (viene despu√©s del verbo)"
                  }
                ],
                estructura: "N√∫cleo + Modificadores (opcionales)"
              },
              {
                nombre: "Sujeto T√°cito (Desinencial)",
                definicion: "El sujeto no se menciona expl√≠citamente, pero se entiende por la conjugaci√≥n del verbo",
                caracteristicas: [
                  "No aparece escrito en la oraci√≥n",
                  "Se deduce por la desinencia (terminaci√≥n) del verbo",
                  "Muy com√∫n en espa√±ol, a diferencia del ingl√©s"
                ],
                ejemplos: [
                  {
                    oracion: "Estudiamos para la PAES todos los d√≠as",
                    analisis: "Sujeto t√°cito: 'Nosotros/Nosotras' (deducido de la terminaci√≥n -amos)"
                  },
                  {
                    oracion: "Lleg√≥ tarde a la clase",
                    analisis: "Sujeto t√°cito: '√âl/Ella/Usted' (deducido de la terminaci√≥n -√≥)"
                  },
                  {
                    oracion: "¬øVas al cine esta noche?",
                    analisis: "Sujeto t√°cito: 'T√∫' (deducido de la terminaci√≥n -as)"
                  }
                ],
                estructura: "‚àÖ (ausente) + Verbo conjugado"
              },
              {
                nombre: "Sujeto Indeterminado",
                definicion: "No se sabe qui√©n realiza la acci√≥n o no interesa especificarlo",
                caracteristicas: [
                  "Se desconoce la identidad del sujeto",
                  "Usa la tercera persona del plural sin sujeto expreso",
                  "Tambi√©n con 'se' + verbo en 3¬™ persona singular"
                ],
                ejemplos: [
                  {
                    oracion: "Dicen que habr√° cambios en la PAES",
                    analisis: "No se sabe qui√©nes dicen (3¬™ persona plural sin sujeto)"
                  },
                  {
                    oracion: "Se vende casa",
                    analisis: "Construcci√≥n con 'se' impersonal"
                  },
                  {
                    oracion: "Llamaron por tel√©fono",
                    analisis: "No se especifica qui√©nes llamaron"
                  }
                ],
                estructura: "Verbo en 3¬™ persona plural / Se + Verbo"
              }
            ],
            reglas: [
              {
                texto: "El sujeto siempre concuerda con el verbo en n√∫mero y persona",
                ejemplo: "Los ni√±os juegan (plural) / El ni√±o juega (singular)"
              },
              {
                texto: "El sujeto puede omitirse en espa√±ol cuando es obvio por el contexto",
                ejemplo: "¬øVas al cine? (t√°cito: t√∫) - S√≠, voy (t√°cito: yo)"
              },
              {
                texto: "Para encontrar el sujeto, pregunta al verbo '¬øqui√©n?' o '¬øqui√©nes?'",
                ejemplo: "Mar√≠a estudia ‚Üí ¬øQui√©n estudia? ‚Üí Mar√≠a (sujeto)"
              }
            ],
            erroresComunes: [
              {
                incorrecto: "Los estudiante estudian",
                correcto: "Los estudiantes estudian",
                explicacion: "El sujeto plural 'los estudiantes' debe concordar con el verbo 'estudian'"
              },
              {
                incorrecto: "Yo y t√∫ vamos al cine",
                correcto: "T√∫ y yo vamos al cine",
                explicacion: "Por cortes√≠a, la 1¬™ persona (yo) va al final en sujetos compuestos"
              }
            ],
            materia: "lenguaje"
          }
        },

        // SLIDE 4: PRACTICE - Construcci√≥n de oraciones
        {
          tipo: "SentenceBuilderSlide",
          orden: 4,
          props: {
            titulo: "Construye Oraciones con Sujetos Variados",
            modoEjercicio: "guided",
            oracionBase: null,
            palabrasDisponibles: [
              { texto: "Los profesores", tipo: "sujeto", color: "blue" },
              { texto: "de la universidad", tipo: "complemento", color: "green" },
              { texto: "explicaron", tipo: "verbo", color: "red" },
              { texto: "detalladamente", tipo: "adverbio", color: "orange" },
              { texto: "el nuevo sistema", tipo: "complemento", color: "green" },
              { texto: "de evaluaci√≥n", tipo: "complemento", color: "green" }
            ],
            objetivoGramatical: "Construye una oraci√≥n con sujeto expreso compuesto por n√∫cleo + modificadores",
            variacionesCorrectas: [
              "Los profesores de la universidad explicaron el nuevo sistema de evaluaci√≥n",
              "Los profesores de la universidad explicaron detalladamente el nuevo sistema",
              "Los profesores explicaron detalladamente el nuevo sistema de evaluaci√≥n",
              "Los profesores de la universidad explicaron detalladamente el nuevo sistema de evaluaci√≥n"
            ],
            mostrarScaffolding: true,
            materia: "lenguaje"
          }
        },

        // SLIDE 5: Transici√≥n a evaluaci√≥n
        {
          tipo: "PracticePromptSlide",
          orden: 5,
          props: {
            mensaje: "¬°Dominas conectores y gram√°tica!",
            submensaje: "Ahora est√°s listo para ejercicios de nivel PAES",
            icono: "üéì",
            previewEjercicios: [
              { tipo: "Conectores textuales", cantidad: 10, icono: "üîó" },
              { tipo: "An√°lisis sint√°ctico", cantidad: 8, icono: "üìù" },
              { tipo: "Comprensi√≥n lectora", cantidad: 5, icono: "üìñ" }
            ],
            motivacion: "Has completado el ciclo: Aprender ‚Üí Practicar ‚Üí Dominar",
            botonTexto: "Ir a Evaluaci√≥n PAES",
            colorTema: "purple",
            materia: "lenguaje"
          }
        }
      ]
    }
  };

  // Handlers
  function handleLeccionComplete(data) {
    console.log('[LessonsDemo] Lecci√≥n completada:', data);
    alert(`¬°Lecci√≥n completada! üéâ\n\nSlides: ${data.slidesCompletados}\nTiempo: ${data.tiempoTotal}s`);
  }

  function handleSlideChange(data) {
    console.log('[LessonsDemo] Cambio de slide:', data);
  }
</script>

<svelte:head>
  <title>Lessons Demo - Lumera</title>
</svelte:head>

<div class="min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950">
  <!-- Header con selector de lecci√≥n -->
  <div class="sticky top-0 z-50 bg-slate-950/95 backdrop-blur-sm border-b border-slate-800">
    <div class="max-w-7xl mx-auto p-4">
      <div class="flex items-center justify-between flex-wrap gap-4">
        <div>
          <h1 class="text-2xl font-bold text-white">
            Componentes de <span class="bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent">Lecciones</span>
          </h1>
          <p class="text-sm text-slate-400">
            Slides educativos interactivos
          </p>
        </div>

        <!-- Selector de lecci√≥n -->
        <div class="flex flex-wrap gap-2">
          <!-- Matem√°ticas -->
          <button
            onclick={() => leccionActiva = 'fotosintesis'}
            class="
              px-4 py-2 rounded-xl font-semibold transition-all duration-300
              {leccionActiva === 'fotosintesis' ? 'bg-emerald-500 text-white shadow-lg shadow-emerald-500/50' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}
            "
          >
            üå± Fotos√≠ntesis
          </button>
          <button
            onclick={() => leccionActiva = 'ecuaciones'}
            class="
              px-4 py-2 rounded-xl font-semibold transition-all duration-300
              {leccionActiva === 'ecuaciones' ? 'bg-cyan-500 text-white shadow-lg shadow-cyan-500/50' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}
            "
          >
            üìê Ecuaciones
          </button>

          <!-- Lenguaje -->
          <button
            onclick={() => leccionActiva = 'comprension-garcia-marquez'}
            class="
              px-4 py-2 rounded-xl font-semibold transition-all duration-300
              {leccionActiva === 'comprension-garcia-marquez' ? 'bg-purple-500 text-white shadow-lg shadow-purple-500/50' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}
            "
          >
            üìö Comprensi√≥n
          </button>
          <button
            onclick={() => leccionActiva = 'gramatica-oraciones'}
            class="
              px-4 py-2 rounded-xl font-semibold transition-all duration-300
              {leccionActiva === 'gramatica-oraciones' ? 'bg-purple-500 text-white shadow-lg shadow-purple-500/50' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}
            "
          >
            ‚úçÔ∏è Gram√°tica
          </button>
          <button
            onclick={() => leccionActiva = 'escritura-argumentativa'}
            class="
              px-4 py-2 rounded-xl font-semibold transition-all duration-300
              {leccionActiva === 'escritura-argumentativa' ? 'bg-purple-500 text-white shadow-lg shadow-purple-500/50' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}
            "
          >
            üìù Escritura
          </button>

          <!-- NUEVA: Lecci√≥n Teach ‚Üí Practice -->
          <button
            onclick={() => leccionActiva = 'conectores-completo'}
            class="
              px-4 py-2 rounded-xl font-semibold transition-all duration-300 border-2
              {leccionActiva === 'conectores-completo' ? 'bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg border-white' : 'bg-slate-800 text-slate-400 hover:bg-slate-700 border-blue-500/30'}
            "
          >
            üéì Teach‚ÜíPractice
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Player de lecci√≥n -->
  {#key leccionActiva}
    <LessonPlayer
      leccion={lecciones[leccionActiva]}
      onComplete={handleLeccionComplete}
      onSlideChange={handleSlideChange}
      showProgress={true}
    />
  {/key}
</div>

<style>
  /* Estilos adicionales si es necesario */
</style>
