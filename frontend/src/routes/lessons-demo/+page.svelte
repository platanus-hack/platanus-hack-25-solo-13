<script>
  import LessonPlayer from '$lib/components/slides/LessonPlayer.svelte';

  // Estado
  let leccionActiva = $state('fotosintesis');

  // Datos de lecciones de ejemplo
  const lecciones = {
    fotosintesis: {
      leccionId: "fotosintesis-intro",
      titulo: "Introducci√≥n a la Fotos√≠ntesis",
      materia: "Biolog√≠a",
      slides: [
        {
          tipo: "ConceptIntroSlide",
          orden: 1,
          props: {
            concepto: "Fotos√≠ntesis",
            definicionSimple: "La fotos√≠ntesis es el proceso mediante el cual las plantas convierten la luz solar en alimento (glucosa), liberando ox√≠geno como subproducto.",
            definicionTecnica: "6CO‚ÇÇ + 6H‚ÇÇO + luz ‚Üí C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ + 6O‚ÇÇ. Proceso anab√≥lico donde organismos aut√≥trofos sintetizan mol√©culas org√°nicas complejas a partir de sustancias simples usando energ√≠a lum√≠nica.",
            imagen: null,
            terminosClave: [
              { palabra: "aut√≥trofos", tooltip: "Organismos que producen su propio alimento, como las plantas" },
              { palabra: "clorofila", tooltip: "Pigmento verde que captura la energ√≠a lum√≠nica" },
              { palabra: "glucosa", tooltip: "Az√∫car simple (C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ) que almacena energ√≠a qu√≠mica" }
            ],
            colorTema: "emerald",
            materia: "biolog√≠a"
          }
        },
        {
          tipo: "StepByStepProcessSlide",
          orden: 2,
          props: {
            titulo: "Las dos fases de la Fotos√≠ntesis",
            pasos: [
              {
                numero: 1,
                titulo: "Fase Luminosa (Reacciones de luz)",
                contenido: "Ocurre en los tilacoides del cloroplasto. La clorofila absorbe luz solar y la convierte en energ√≠a qu√≠mica (ATP y NADPH). Se libera ox√≠geno al descomponer mol√©culas de agua.",
                ejemplo: "H‚ÇÇO + luz ‚Üí O‚ÇÇ + ATP + NADPH",
                ayudaVisual: null
              },
              {
                numero: 2,
                titulo: "Fase Oscura (Ciclo de Calvin)",
                contenido: "Ocurre en el estroma del cloroplasto. Usa el ATP y NADPH de la fase luminosa para convertir CO‚ÇÇ en glucosa. No requiere luz directa.",
                ejemplo: "CO‚ÇÇ + ATP + NADPH ‚Üí C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ",
                ayudaVisual: null
              },
              {
                numero: 3,
                titulo: "Producto Final",
                contenido: "La glucosa producida se usa para crecimiento, almacenamiento de energ√≠a (almid√≥n) o respiraci√≥n celular. El ox√≠geno se libera a la atm√≥sfera.",
                ejemplo: "1 mol√©cula de glucosa = energ√≠a para 38 mol√©culas de ATP",
                ayudaVisual: null
              }
            ],
            materia: "biolog√≠a",
            requiereConfirmacion: false,
            mostrarProgreso: true
          }
        },
        {
          tipo: "ComparisonTableSlide",
          orden: 3,
          props: {
            titulo: "Fase Luminosa vs Fase Oscura",
            items: [
              { nombre: "Fase Luminosa", color: "yellow" },
              { nombre: "Fase Oscura", color: "purple" }
            ],
            filas: [
              {
                caracteristica: "Ubicaci√≥n",
                valores: ["Tilacoides", "Estroma"],
                tipo: "diferencia",
                detalles: "Los tilacoides son membranas internas del cloroplasto, el estroma es el fluido que los rodea"
              },
              {
                caracteristica: "Requiere luz",
                valores: ["S√≠, directamente", "No directamente"],
                tipo: "diferencia",
                detalles: "La fase oscura usa productos de la fase luminosa, pero no necesita luz en ese momento"
              },
              {
                caracteristica: "Productos",
                valores: ["ATP, NADPH, O‚ÇÇ", "Glucosa (C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ)"],
                tipo: "diferencia"
              },
              {
                caracteristica: "Reactivos principales",
                valores: ["H‚ÇÇO, luz", "CO‚ÇÇ, ATP, NADPH"],
                tipo: "diferencia"
              },
              {
                caracteristica: "Funci√≥n",
                valores: ["Capturar energ√≠a", "Sintetizar glucosa"],
                tipo: "diferencia"
              }
            ],
            materia: "biolog√≠a",
            mostrarFiltros: true
          }
        },
        {
          tipo: "PracticePromptSlide",
          orden: 4,
          props: {
            mensaje: "¬°Ahora dominas la Fotos√≠ntesis!",
            submensaje: "Refuerza lo aprendido con algunos ejercicios pr√°cticos",
            icono: "üå±",
            previewEjercicios: [
              { tipo: "Verdadero/Falso", cantidad: 3, icono: "‚úì‚úó" },
              { tipo: "Selecci√≥n M√∫ltiple", cantidad: 5, icono: "‚òëÔ∏è" },
              { tipo: "Completar Blancos", cantidad: 2, icono: "___" }
            ],
            motivacion: "¬°Excelente! Ya comprendes el 70% de Biolog√≠a Celular",
            botonTexto: "Comenzar Ejercicios",
            colorTema: "emerald",
            materia: "biolog√≠a"
          }
        }
      ]
    },

    ecuaciones: {
      leccionId: "ecuaciones-segundo-grado",
      titulo: "Ecuaciones de Segundo Grado",
      materia: "Matem√°ticas",
      slides: [
        {
          tipo: "ConceptIntroSlide",
          orden: 1,
          props: {
            concepto: "Ecuaci√≥n Cuadr√°tica",
            definicionSimple: "Una ecuaci√≥n de segundo grado es aquella donde la variable est√° elevada al cuadrado. Tiene la forma ax¬≤ + bx + c = 0.",
            definicionTecnica: "Ecuaci√≥n polin√≥mica de grado 2 de la forma ax¬≤ + bx + c = 0, donde a ‚â† 0. Sus soluciones se obtienen mediante la f√≥rmula general: x = (-b ¬± ‚àö(b¬≤-4ac)) / 2a",
            imagen: null,
            terminosClave: [
              { palabra: "coeficientes", tooltip: "Los n√∫meros a, b, c que multiplican a las variables" },
              { palabra: "discriminante", tooltip: "b¬≤-4ac, determina el n√∫mero de soluciones reales" },
              { palabra: "ra√≠ces", tooltip: "Los valores de x que satisfacen la ecuaci√≥n" }
            ],
            colorTema: "cyan",
            materia: "matem√°ticas"
          }
        },
        {
          tipo: "StepByStepProcessSlide",
          orden: 2,
          props: {
            titulo: "Resolver una Ecuaci√≥n Cuadr√°tica",
            pasos: [
              {
                numero: 1,
                titulo: "Identificar coeficientes a, b, c",
                contenido: "En la forma ax¬≤ + bx + c = 0, identifica los valores de a (coeficiente de x¬≤), b (coeficiente de x), y c (t√©rmino independiente).",
                ejemplo: "2x¬≤ + 5x - 3 = 0 ‚Üí a=2, b=5, c=-3"
              },
              {
                numero: 2,
                titulo: "Calcular el discriminante",
                contenido: "Calcula Œî = b¬≤ - 4ac. Este valor determina cu√°ntas soluciones reales tiene la ecuaci√≥n.",
                ejemplo: "Œî = 5¬≤ - 4(2)(-3) = 25 + 24 = 49"
              },
              {
                numero: 3,
                titulo: "Aplicar la f√≥rmula general",
                contenido: "Sustituye en x = (-b ¬± ‚àöŒî) / 2a para obtener las dos soluciones.",
                ejemplo: "x = (-5 ¬± ‚àö49) / 4 = (-5 ¬± 7) / 4"
              },
              {
                numero: 4,
                titulo: "Calcular ambas soluciones",
                contenido: "Resuelve con + y con - para obtener x‚ÇÅ y x‚ÇÇ.",
                ejemplo: "x‚ÇÅ = (-5 + 7) / 4 = 0.5; x‚ÇÇ = (-5 - 7) / 4 = -3"
              }
            ],
            materia: "matem√°ticas",
            requiereConfirmacion: true,
            mostrarProgreso: true
          }
        },
        {
          tipo: "FormulaExplorerSlide",
          orden: 3,
          props: {
            titulo: "Explora la F√≥rmula General",
            formula: "x = (-b ¬± ‚àö(b¬≤-4ac)) / 2a",
            variables: [
              {
                simbolo: "a",
                nombre: "Coeficiente cuadr√°tico",
                unidad: "",
                descripcion: "Coeficiente del t√©rmino x¬≤ (debe ser ‚â† 0)"
              },
              {
                simbolo: "b",
                nombre: "Coeficiente lineal",
                unidad: "",
                descripcion: "Coeficiente del t√©rmino x"
              },
              {
                simbolo: "c",
                nombre: "T√©rmino independiente",
                unidad: "",
                descripcion: "T√©rmino constante sin variable"
              }
            ],
            ejemploNumerico: {
              a: 1,
              b: -3,
              c: 2,
              sustitucion: "x = (3 ¬± ‚àö(9-8)) / 2 = (3 ¬± 1) / 2",
              resultado: "x‚ÇÅ = 2, x‚ÇÇ = 1",
              unidadResultado: ""
            },
            calculadoraInteractiva: false,
            materia: "matem√°ticas",
            mostrarUnidades: false
          }
        },
        {
          tipo: "PracticePromptSlide",
          orden: 4,
          props: {
            mensaje: "¬°Listo para resolver ecuaciones!",
            submensaje: "Practica con 10 ecuaciones de dificultad progresiva",
            icono: "üéØ",
            previewEjercicios: [
              { tipo: "Ecuaciones simples", cantidad: 3, icono: "üìê" },
              { tipo: "Ecuaciones intermedias", cantidad: 4, icono: "üìä" },
              { tipo: "Problemas aplicados", cantidad: 3, icono: "üßÆ" }
            ],
            motivacion: "Dominas el 85% de √Ålgebra - ¬°Sigue as√≠!",
            botonTexto: "Practicar Ahora",
            colorTema: "cyan",
            materia: "matem√°ticas"
          }
        }
      ]
    }
  };

  // Handlers
  function handleLeccionComplete(data) {
    console.log('[LessonsDemo] Lecci√≥n completada:', data);
    alert(`¬°Lecci√≥n completada! üéâ\n\nSlides: ${data.slidesCompletados}\nTiempo: ${data.tiempoTotal}s`);
  }

  function handleSlideChange(data) {
    console.log('[LessonsDemo] Cambio de slide:', data);
  }
</script>

<svelte:head>
  <title>Lessons Demo - Lumera</title>
</svelte:head>

<div class="min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950">
  <!-- Header con selector de lecci√≥n -->
  <div class="sticky top-0 z-50 bg-slate-950/95 backdrop-blur-sm border-b border-slate-800">
    <div class="max-w-7xl mx-auto p-4">
      <div class="flex items-center justify-between flex-wrap gap-4">
        <div>
          <h1 class="text-2xl font-bold text-white">
            Componentes de <span class="bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent">Lecciones</span>
          </h1>
          <p class="text-sm text-slate-400">
            Slides educativos interactivos
          </p>
        </div>

        <!-- Selector de lecci√≥n -->
        <div class="flex gap-2">
          <button
            onclick={() => leccionActiva = 'fotosintesis'}
            class="
              px-4 py-2 rounded-xl font-semibold transition-all duration-300
              {leccionActiva === 'fotosintesis' ? 'bg-emerald-500 text-white shadow-lg shadow-emerald-500/50' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}
            "
          >
            üå± Fotos√≠ntesis
          </button>
          <button
            onclick={() => leccionActiva = 'ecuaciones'}
            class="
              px-4 py-2 rounded-xl font-semibold transition-all duration-300
              {leccionActiva === 'ecuaciones' ? 'bg-cyan-500 text-white shadow-lg shadow-cyan-500/50' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}
            "
          >
            üìê Ecuaciones
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Player de lecci√≥n -->
  {#key leccionActiva}
    <LessonPlayer
      leccion={lecciones[leccionActiva]}
      onComplete={handleLeccionComplete}
      onSlideChange={handleSlideChange}
      showProgress={true}
    />
  {/key}
</div>

<style>
  /* Estilos adicionales si es necesario */
</style>
